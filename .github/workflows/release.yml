name: CI

on: 
  release:
    types: [published]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Set version ${{ github.event.release.name }}!
      uses: microsoft/variable-substitution@v1
      with:
        files: 'manifest.json'
      env:
        version: ${{ github.event.release.name }}
    - name: Create zip file
      run: |
        zip -u deezer_${{ github.event.release.name }}.zip LICENSE.txt,
        zip -u deezer_${{ github.event.release.name }}.zip manifest.json,
        zip -u deezer_${{ github.event.release.name }}.zip *.html,
        zip -ur deezer_${{ github.event.release.name }}.zip css,
        zip -ur deezer_${{ github.event.release.name }}.zip imgs,
        zip -ur deezer_${{ github.event.release.name }}.zip _locales,
        zip -ur deezer_${{ github.event.release.name }}.zip scripts, 
        echo Zip created!
    - name: Upload Chrome Extension Webstore artifact
      uses: actions/upload-artifact@v1
      with:
        path: deezer_${{ github.event.release.name }}.zip
        
        
